# Cinego

此库为minimind-v所衍生的轻量视频理解大模型。

## 使用方法

### 1.训练tokenizer（可选，你也可以用我训练好的）

```shell
python train_tokenizer.py
```

### 2.提取视频特征(可选，你也可以直接下载我提取好的特征)

```shell
python preprocess.py
```

### 3.训练预训练模型

```shell
python train_pretrain.py
```

### 4.训练SFT模型

```shell
python train_sft.py
```

### 5.测试模型

```shell
python eval.py
```


## 数据集


### 由于视频数据集实在太大了，这里我的Pretrain与SFT数据集选择的均为[LLaVA-Video-178K](https://huggingface.co/datasets/lmms-lab/LLaVA-Video-178K/tree/main)中的0_30_s_academic_v0_1子集


## 视频理解对比

| 视频文件名 | 机器理解 (🤖️) | 人类理解 (👨) |
|-----------|--------------|--------------|
| **0AGCS.mp4** | 场景设定在一个狭小昏暗的房间，米色墙壁，顶部有一扇白门。一名穿红衬衫的人右手持白色马克杯进入画面，走向门后左转朝镜头走来。开门后与地上的狗互动，最后狗保持静止，偶尔张望。 | 视频开始于一人站在门口，手持格子毛毯，穿黑色T恤和卡其裤。背景房间杂乱，有椅子和设备。人物调整毛毯包裹自己，可能准备移动或使用。结尾人物换灰色连帽衫，将毛毯丢地后拾起，似准备搬运。 |
| **0AMBV.mp4** | 温馨客厅中，穿白T恤黑裤的女子坐在红色沙发上，手持绿色瓶子和不明小物件。她整理沙发物品，似在布置房间。 | 暖光走廊中，椅子搭着毛毯，门挂花帘。穿深色毛衣者调整毛毯后离开。另一场景为蓝色吸尘器旁，穿蓝夹克红裤者持吸尘管准备清洁。 |
| **0AYPZ.mp4** | 蓝色夹克者从玻璃木门进入房间，内有书桌、黄布小桌和黑白地毯。人物时而看笔记本电脑，时而检查门。 | 明亮厨房中，穿深色上衣者用红锅烹饪，台面有绿容器和植物。后喝水并洗杯，最后继续搅拌锅中食物。 |
| **0BLSL.mp4** | 厨房内穿深色长袖者用白布操作冰箱，后持白盘检查。台面有水瓶、橄榄油瓶等，人物似在备餐。 | 昏暗小房间内，穿黑夹克者将文件和红文件夹放冰柜上，后换连帽衫铺紫色塑料袋并整理纸张。 |
| **0BX9N.mp4** | 穿黑衣黑裤者站在米色墙房间，持物体专注查看并进食。结尾走向右侧，似持续关注手中物。 | 女子在厨房拆解塑料袋中食品（意面、喷雾油、蔬菜），整理后开火准备烹饪。 |

### 结论
- 数据集还是太小了，有许多胡言乱语的描述
- 直接取平均的操作可能不能很好地表达视频的特征


## 致谢

- 特别感谢 [MiniMind](https://github.com/jingyaogong/minimind-v) 项目，本项目的架构和实现大量借鉴了他们的优秀工作
- 感谢 [LLaVA-Video-178K](https://huggingface.co/datasets/lmms-lab/LLaVA-Video-178K/tree/main)数据集的提供者
